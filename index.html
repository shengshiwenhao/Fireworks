<!DOCTYPE html>  
<html>  
<head>  
<title>to 王琪靓</title>
<meta charset="UTF-8">
<style>
body{
    margin:0;
    width: 100vw;
    height: 100vh;
    overflow:hidden;
    background:url("image/starSky.jfif") no-repeat;
    background-size: 100% 100%;
    opacity: 0.85;
}    
.myHeart{
    position:relative;
    width:400px;
    height:400px;
    margin:-110px auto 200px;
    animation: move 2s infinite alternate;
    display: none;
    z-index: 555;
}
.myHeart:before,
.myHeart:after{
    content: '' ;
    position:absolute;
    left:60px;
    top:150px;
    width:200px;
    height:320px;
    background:red;
    border-radius:100px 100px 0px 0px;
}
.myHeart:before{
    content: '';
    transform:rotate(-45deg);
}
.myHeart:after{
    content: '';
    transform: translateX(83px) rotate(45deg);
    }
.myHeart p{
    position: absolute;
    width: 300px;
    z-index: 999;
    left:50px;
    top:200px;
    line-height: 28px;
    text-align: center;
    font-size: 24px;
}
@keyframes move{
0%{transform:scale(1.1);}
25%{transform:scale(1.2);}
50%{transform:scale(1.3);}
75%{transform:scale(1.2);}
100%{transform:scale(1.1);}
}
.wwh,.wql{
 color: red;
 margin: 0 auto;
 position: relative;
 text-align: center;
 z-index: 1000;
 font-size: 199px;
 font-weight: 700;
 display: none;
}
.time{
 width: 80vw;
 height: 100vh;
 padding: 100px 50px;
 color: orangered;
 font-size: 50px;
 font-weight: 700;
 z-index: 1000;
 text-align: center;
 position: absolute;
 top:0;
 left:0;
 display: none; 
}
</style>   
</head>  
<body>
    <h1 class="wwh">仵文豪</h1>
    <div class="myHeart">
        <p>
            我想说的话<br>
            很多时候都不知道怎么表达<br>
            爱总是藏在心里<br>
            你知不知道也藏在这句子里<br>
        </p>
    </div>
    <div class="time"></div>
    <h1 class="wql">王琪靓</h1> 
    <canvas id="fireworks">
    </canvas> 
</body>  
</html>
<script type="text/javascript"> 
    window.onload = function () { 
        setTimeout(function(){
            var audio = document.createElement('audio');
            audio.src = 'image/love.mp3';
            audio.autoplay = 'autoplay';
            audio.loop = 'loop';
            document.body.appendChild(audio)
        },5000)           
        fireworks = document.getElementById("fireworks");
        myHeart = document.querySelector(".myHeart");
        wwh = document.querySelector(".wwh");
        wql = document.querySelector(".wql");
        time = document.querySelector(".time");  
        fws = fireworks.getContext("2d"); 
        fwsWidth = fireworks.width = window.innerWidth; 
        fwsHeight = fireworks.height = window.innerHeight; 
        fws.fillRect(0, 0, fwsWidth, fwsHeight); 
        fws.globalCompositeOperation = "lighter"; 
        fws.lineWidth = 0.2; 
        fws.lineCap = "round";       
        var bool = 0, radius = 0,angle = 0;
        fireworks.onmousemove = function (event) {  
            if (window.fwsTime) {  
                if (fwsRandom == 9) { 
                    fwsRandom = Math.random() * 15; 
                    fwsCallback(1); 
                }  
                clearTimeout(fwsTime);  
            }  
            beforeX = event.pageX; 
            beforeY = event.pageY;  
            presentX = beforeX, 
            presentY = beforeY;
            startX = 0; 
            startY = 0; 
            XW = (event.pageX / fwsWidth * 999 >> 0) / 999; 
            YH = (event.pageY / fwsHeight * 999 >> 0) / 999; 
            angle = event.pageX / fwsHeight * 360 >> 0; 
            fwsRandom = 9; 
            circle = 360 * Math.PI / 180; 
            fwsTime = setInterval(fwsCallback = function (event) {  
                fws.save(); 
                fws.globalCompositeOperation = "source-over"; 
                if (event != 1) { 
                    fws.fillStyle = "rgba(0,0,0,0.02)"; 
                    fws.fillRect(0, 0, fwsWidth, fwsHeight); 
                }  
                fws.restore(); 
                ring = 25; 
                while (ring--) {  
                    fws.beginPath(); 
                    if (fwsRandom > 450 || bool) {  
                        if (!bool) { 
                            bool = 1; 
                        }  
                        if (fwsRandom < 0.1) { 
                            bool = 0; 
                        }  
                        radius -= circle; 
                        fwsRandom -= 0.1;  
                    }  
                    if (!bool) { 
                        radius += circle; 
                        fwsRandom += 0.1; 
                    }  
                    q = (XW / YH - 1) * radius; 
                    endX = (XW - YH) * Math.cos(radius) + fwsRandom * Math.cos(q) + (presentX + (beforeX - presentX) * (ring / 25)) + (YH - XW); 
                    endY = (XW - YH) * Math.sin(radius) - fwsRandom * Math.sin(q) + (presentY + (beforeY - presentY) * (ring / 25)); 
                    if (startX) { 
                        fws.moveTo(startX, startY); 
                        fws.lineTo(endX, endY) 
                    }  
                    fws.strokeStyle = "hsla(" + (angle % 360) + ",100%,50%,0.75)"; 
                    fws.stroke(); 
                    startX = endX; 
                    startY = endY;  
                }  
                angle -= 0.5;
                presentX = beforeX; 
                presentY = beforeY;  
            }, 16);  
        }  
        document.onkeydown = function (event) { 
            startX = startY = 0; 
            XW += 0.05 
        }
        var num = 0;
        var jump = 0;
        var timeUp = 121;
        var content = '';
        var text = `我第一次见到你就喜欢你了,我感觉我挺幸运的,终于找到我爱的人了,我在心里告诉自己一定不要错过你,你就是我的幸福,和你在一起我很开心,我每时每刻都在想你,宝贝,520快乐,愿以后的每一天,我们能一起携手度过。`
        var split = text.split('').reverse()
        console.log(split);
        var timer = setInterval(()=>{
            timeUp--;
            if(timeUp<112){
                time.style.display = 'block'
                if (timeUp>9) {
                    if(split[timeUp-10] === ','){
                        split[timeUp-10] = ','+'<br>'
                    }
                  content += split[timeUp-10]
                  console.log(content);
                    time.innerHTML = content 
                } 
                if (timeUp<10) {
                  content = Math.ceil(timeUp/2)
                  console.log(content);
                    time.innerHTML = content 
                } 
            }
            if (timeUp<0) {
                fireworks.style.display = 'none'
                time.style.display = 'none'
                myHeart.style.display = 'block'
                wwh.style.display = 'block'
                wql.style.display = 'block'
                clearInterval(timer)
            }
            num = Math.floor(Math.random()*(window.innerWidth))
            jump = Math.floor(Math.random()*(window.innerHeight))
            console.log(num,jump,timeUp);
            fireworks.onmousemove({ 
            pageX: num, 
            pageY: jump 
        })
        },500)
    }
</script>  